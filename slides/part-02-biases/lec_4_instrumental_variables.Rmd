---
title: "Causal Inference for Data Science"
subtitle: "ITAM Short Workshop"
author: "Mathew Kiang, Zhe Zhang, Monica Alexander"
date: "March 15, 2017"
output:
  xaringan::moon_reader:
    css: ["custom.css", "./../custom.css", ]
    # In order for the css file to work, you need to set your working directory
    # to one above the slide directory ('./../') and then call moon_reader via
    # `xaringan::inf_mr('./part-01-intro/index.Rmd')`
    # Or just knit it into a browser and it should work immediately.
    lib_dir: libs
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---
name: inverse
layout: true
class: center, middle, inverse

```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
```

---


---
# Omitted Variables

- we rarely "prove" causality
- instead, we argue based on domain expertise and theory that we are not facing biases
- often, a good analysis adjusts a lot of the assumptions to ensure the results are "robust" to possible biases

---
# Instrumental Variables

- any other variables in the world or data that helps to encourage a real-world experiment
- by leveraging this information, we can remove omitted variable bias
- denote such instruments with $z_i$ variables for each observation $i$

---
# Instrumental Variables Graphically

- replace with our own graphics for consistent letters

![iv_base](./assets/iv_no_issue.png) ![iv_base](./assets/iv_confound.png)
![iv_base](./assets/iv_with_z.png)

---
# Instrumental Variable Key

- instead of using the observed $X_i$ or $T_i$, which may be influenced by confounders,
we use a predicted version of $\hat{X_i}$, which does not suffer from influence from confounders.

- "good instruments come from a combination of institutional knowledge and ideas about the processes determining the variables of interest" (Angrist & Pischke)
  - i.e., it's not just about data
  
---
# Various Types of Instruments

- natural experiments
- policy variation
- policy/implementation details
- actions taken by third parties

---
# Various Types of Instruments

- examples of and papers using different types 

---
# Caveats about IV

- we can never "prove" that an IV is valid, it has to be argued
- we can show that an IV is weak sometimes though
- beware of internal validity causality; LATE
  - causality is determined based on meaningful variation (e.g., randomized experiment); an IV may only lead to meaningful variation for a small part of the population (e.g., RD)
  - can help inform our theoretical understanding
  - comes up when we consider the more realistic scenario that casual effects are heterogeneous

---
# LATE

- only estimate the avg causal effect for those who are affected
- those who are affected by all be affected in the same direction; otherwise it complicates calculation
  - this is a hypothetical/theoretical assumption, we can never know
- "IV solves the problem of causal inference in a randomized trial with partial compliance" (Angrist, Pischke)

---
# Intention to Treat in Randomized Treatments

- some people who choose to decline a randomized offer/treatment
- use the offer variable as an IV
![iv_itt_effects](./assets/iv_rct_itt_effects_regression.png)

---
# Characterizing Instruments

- it's also useful to consider some numbers around LATE
  - how many "compliers"/"affected" do we have?
  - what % of our observed treated were affected by $IV$/$z$?

![iv_size_of_compliers](./assets/iv_size_of_compliers.png)

- small group of "compliers"" is not necessarily bad (like only those on the margin of usefulness)

- (optional) also can compare composition of descriptive variables of the compliers to others.

--- 
# Lots more Details on IV

- see book and reading for additional (multiple instruments, interpretation and math of instruments with covariates, IVs for continuous treatment variables)
- key overall idea: look for things in the world/nature/policies that results in some random variation! Finding that is the most difficult part. Once you find it, you can refer to math and textbooks and references to nail the correct interpretation/identification.

- "key source of variation"
- "what's your identification (strategy)"
- be excited but cautious though, there are a lot of ways things can go wrong
  - different functional forms for the instrument

- overall key advice: always be cautious and recognizing the assumptions that go into causal work. Valuable exercise to think through skeptically.

---
# Sources

- Cameron & Triveti textbook
- Mostly Harmless Econometrics
- Osea Giuntella, slides